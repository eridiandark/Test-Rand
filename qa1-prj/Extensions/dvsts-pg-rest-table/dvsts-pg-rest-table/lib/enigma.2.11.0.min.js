!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).enigma=t()}(this,(function(){"use strict";var e={};function t(){t.init.call(this)}e.isObject=function(e){return"object"==typeof e&&null!==e},e.isNumber=function(e){return"number"==typeof e},e.isUndefined=function(e){return void 0===e},e.isFunction=function(e){return"function"==typeof e};var n=t;t.EventEmitter=t,t.prototype._events=void 0,t.prototype._maxListeners=void 0,t.defaultMaxListeners=10,t.init=function(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0},t.prototype.setMaxListeners=function(t){if(!e.isNumber(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},t.prototype.emit=function(t){var n,r,o,i,s,u;if(this._events||(this._events={}),"error"===t&&!this._events.error)throw(n=arguments[1])instanceof Error?n:Error('Uncaught, unspecified "error" event.');if(r=this._events[t],e.isUndefined(r))return!1;if(e.isFunction(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:for(o=arguments.length,i=new Array(o-1),s=1;s<o;s++)i[s-1]=arguments[s];r.apply(this,i)}else if(e.isObject(r)){for(o=arguments.length,i=new Array(o-1),s=1;s<o;s++)i[s-1]=arguments[s];for(o=(u=r.slice()).length,s=0;s<o;s++)u[s].apply(this,i)}return!0},t.prototype.addListener=function(n,r){var o;if(!e.isFunction(r))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",n,e.isFunction(r.listener)?r.listener:r),this._events[n]?e.isObject(this._events[n])?this._events[n].push(r):this._events[n]=[this._events[n],r]:this._events[n]=r,e.isObject(this._events[n])&&!this._events[n].warned)&&((o=e.isUndefined(this._maxListeners)?t.defaultMaxListeners:this._maxListeners)&&o>0&&this._events[n].length>o&&(this._events[n].warned=!0,e.isFunction(console.error)&&console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[n].length),e.isFunction(console.trace)&&console.trace()));return this},t.prototype.on=t.prototype.addListener,t.prototype.once=function(t,n){if(!e.isFunction(n))throw TypeError("listener must be a function");var r=!1;function o(){this.removeListener(t,o),r||(r=!0,n.apply(this,arguments))}return o.listener=n,this.on(t,o),this},t.prototype.removeListener=function(t,n){var r,o,i,s;if(!e.isFunction(n))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=(r=this._events[t]).length,o=-1,r===n||e.isFunction(r.listener)&&r.listener===n)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,n);else if(e.isObject(r)){for(s=i;s-- >0;)if(r[s]===n||r[s].listener&&r[s].listener===n){o=s;break}if(o<0)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,n)}return this},t.prototype.removeAllListeners=function(t){var n,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(n in this._events)"removeListener"!==n&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],e.isFunction(r))this.removeListener(t,r);else if(Array.isArray(r))for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},t.prototype.listeners=function(t){return this._events&&this._events[t]?e.isFunction(this._events[t])?[this._events[t]]:this._events[t].slice():[]},t.listenerCount=function(t,n){return t._events&&t._events[n]?e.isFunction(t._events[n])?1:t._events[n].length:0};var r=function(e){Object.keys(n.prototype).forEach((function(t){e[t]=n.prototype[t]})),n.init(e)};function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,s=void 0,s=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===o(s)?s:String(s)),r)}var i,s}function s(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){var t="function"==typeof Map?new Map:void 0;return u=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return c(e,arguments,f(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),l(r,e)},u(e)}function c(e,t,n){return c=a()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&l(o,n.prototype),o},c.apply(null,arguments)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(p,e);var t,n,r,o,u,c=(t=p,n=a(),function(){var e,r=f(t);if(n){var o=f(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return s(this,e)});function p(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(r=c.call(this,e)).code=t,r.enigmaError=!0,r.original=n,r}return r=p,o&&i(r.prototype,o),u&&i(r,u),Object.defineProperty(r,"prototype",{writable:!1}),r}(u(Error));function h(e,t,n){return new p(t,e,n)}var y=-1,v=-2,d=-3,m=-4,b=-5,g=-6,w=-7,j=-8,S=-9,O=-10,P=-11,k=-12;function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){R(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function R(e,t,n){return(t=q(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,q(r.key),r)}}function q(e){var t=function(e,t){if("object"!==E(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===E(t)?t:String(t)}var x=0,C=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=this;Object.assign(n,t),this.Promise=this.config.Promise,this.definition=this.config.definition,r(n),x+=1,n.id=x,n.rpc.on("socket-error",n.onRpcError.bind(n)),n.rpc.on("closed",n.onRpcClosed.bind(n)),n.rpc.on("message",n.onRpcMessage.bind(n)),n.rpc.on("notification",n.onRpcNotification.bind(n)),n.rpc.on("traffic",n.onRpcTraffic.bind(n)),n.on("closed",(function(){return n.onSessionClosed()}))}var t,n,o;return t=e,n=[{key:"onRpcError",value:function(e){this.suspendResume.isSuspended||this.emit("socket-error",e)}},{key:"onRpcClosed",value:function(e){var t=this;if(!this.suspendResume.isSuspended&&1e3!==e.code&&4e3!==e.code)if(this.config.suspendOnClose){var n=e.code,r=e.reason;this.suspendResume.suspend().then((function(){return t.emit("suspended",{initiator:"network",code:n,reason:r})}))}else this.emit("closed",e)}},{key:"onRpcMessage",value:function(e){var t=this;this.suspendResume.isSuspended||(e.change&&e.change.forEach((function(e){return t.emitHandleChanged(e)})),e.close&&e.close.forEach((function(e){return t.emitHandleClosed(e)})))}},{key:"onRpcNotification",value:function(e){this.emit("notification:*",e.method,e.params),this.emit("notification:".concat(e.method),e.params)}},{key:"onRpcTraffic",value:function(e,t,n){this.emit("traffic:*",e,t),this.emit("traffic:".concat(e),t);var r=this.apis.getApi(n);r&&(r.emit("traffic:*",e,t),r.emit("traffic:".concat(e),t))}},{key:"onSessionClosed",value:function(){this.apis.getApis().forEach((function(e){e.api.emit("closed"),e.api.removeAllListeners()})),this.apis.clear()}},{key:"getObjectApi",value:function(e){var t=e.handle,n=e.id,r=e.type,o=e.genericType,i=this.apis.getApi(t);return i||(i=this.definition.generate(r)(this,t,n,o),this.apis.add(t,i),i)}},{key:"open",value:function(){var e=this;if(!this.globalPromise){var t={handle:-1,id:"Global",type:"Global",genericType:"Global"};this.globalPromise=this.rpc.open().then((function(){return e.getObjectApi(t)})).then((function(t){return e.emit("opened"),t}))}return this.globalPromise}},{key:"send",value:function(t){var n=this;if(this.suspendResume.isSuspended)return this.Promise.reject(h(P,"Session suspended",this.rpc.closeEvent));t.id=this.rpc.createRequestId();var r=this.intercept.executeRequests(this,this.Promise.resolve(t)).then((function(e){var r=A(A({},n.config.protocol),e);delete r.outKey;var o=n.rpc.send(r);return e.retry=function(){return n.send(t)},n.intercept.executeResponses(n,o,e)}));return e.addToPromiseChain(r,"requestId",t.id),r}},{key:"suspend",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4e3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.suspendResume.suspend(t,n).then((function(){return e.emit("suspended",{initiator:"manual",code:t,reason:n})}))}},{key:"resume",value:function(e){var t=this;return this.suspendResume.resume(e).then((function(e){return t.emit("resumed"),e}))}},{key:"close",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.globalPromise=void 0,this.rpc.close(t,n).then((function(t){return e.emit("closed",t)}))}},{key:"emitHandleChanged",value:function(e){var t=this.apis.getApi(e);t&&t.emit("changed")}},{key:"emitHandleClosed",value:function(e){var t=this.apis.getApi(e);t&&(t.emit("closed"),t.removeAllListeners())}}],o=[{key:"addToPromiseChain",value:function(t,n,r){t[n]=r;var o=t.then;t.then=function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];var u=o.apply(this,i);return e.addToPromiseChain(u,n,r),u}}}],n&&T(t.prototype,n),o&&T(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==I(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===I(i)?i:String(i)),r)}var o,i}var N=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.entries={}}var t,n,r;return t=e,(n=[{key:"add",value:function(e,t){if(e+="",void 0!==this.entries[e])throw h(b,"Entry already defined with key ".concat(e));this.entries[e]=t}},{key:"set",value:function(e,t){e+="",this.entries[e]=t}},{key:"remove",value:function(e){delete this.entries[e]}},{key:"get",value:function(e){return this.entries[e]}},{key:"getAll",value:function(){var e=this;return Object.keys(this.entries).map((function(t){return{key:t,value:e.entries[t]}}))}},{key:"getKey",value:function(e){var t=this;return Object.keys(this.entries).filter((function(n){return t.entries[n]===e}))[0]}},{key:"clear",value:function(){this.entries={}}}])&&L(t.prototype,n),r&&L(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==F(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==F(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===F(i)?i:String(i)),r)}var o,i}function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}var G=Object.prototype.hasOwnProperty;function M(e){return e.substring(0,1).toLowerCase()+e.substring(1)}function H(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];if(1===r.length&&"object"===F(r[0])&&!Array.isArray(r[0])){var i=Object.keys(r[0]).every((function(e){return G.call(t,e)}));i&&(r=Object.keys(t).map((function(e){return r[0][e]||t[e]})))}return e.apply(this,r)}var B=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.Promise=t.Promise,this.schema=t.schema,this.mixins=new N,this.types=new N}var t,n,o;return t=e,n=[{key:"registerMixin",value:function(e){var t=this,n=e.types,r=e.type,o=e.extend,i=e.override,s=e.init;Array.isArray(n)||(n=[n]),r&&n.push(r);var u={extend:o,override:i,init:s};n.forEach((function(e){var n=t.mixins.get(e);n?n.push(u):t.mixins.add(e,[u])}))}},{key:"generate",value:function(e){var t=this.types.get(e);if(t)return t;if(!this.schema.structs[e])throw h(j,"".concat(e," not found"));var n=this.generateApi(e,this.schema.structs[e]);return this.types.add(e,n),n}},{key:"generateApi",value:function(e,t){var n=Object.create({});return this.generateDefaultApi(n,t),this.mixinType(e,n),this.mixinNamedParamFacade(n,t),function(t,o,i,s){var u=this,c=Object.create(n);r(c),Object.defineProperties(c,{session:{enumerable:!0,value:t},handle:{enumerable:!0,value:o,writable:!0},id:{enumerable:!0,value:i},type:{enumerable:!0,value:e},genericType:{enumerable:!0,value:s}});var a=this.mixins.get(e)||[];return s!==e&&(this.mixinType(s,c),a=a.concat(this.mixins.get(s)||[])),a.forEach((function(e){"function"==typeof e.init&&e.init({config:u.config,api:c})})),c}.bind(this)}},{key:"generateDefaultApi",value:function(e,t){Object.keys(t).forEach((function(n){var r=t[n].Out,o=1===r.length?r[0].Name:-1,i=M(n);e[i]=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.session.send({handle:this.handle,method:n,params:t,outKey:o})}}))}},{key:"mixinType",value:function(e,t){var n=this.mixins.get(e);n&&n.forEach((function(n){var r=n.extend,o=void 0===r?{}:r,i=n.override,s=void 0===i?{}:i;Object.keys(s).forEach((function(n){if("function"!=typeof t[n]||"function"!=typeof s[n])throw h(S,"No function to override. Type: ".concat(e," function: ").concat(n));var r=t[n];t[n]=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return s[n].apply(this,[r.bind(this)].concat(t))}})),Object.keys(o).forEach((function(n){if("function"==typeof t[n]&&"function"==typeof o[n])throw h(O,"Extend is not allowed for this mixin. Type: ".concat(e," function: ").concat(n));t[n]=o[n]}))}))}},{key:"mixinNamedParamFacade",value:function(e,t){Object.keys(t).forEach((function(n){var r=M(n),o=e[r],i=t[n].In.reduce((function(e,t){return e[t.Name]=t.DefaultValue,e}),{});e[r]=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return H.apply(this,[o,i].concat(t))}}))}}],n&&D(t.prototype,n),o&&D(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==W(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==W(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===W(i)?i:String(i)),r)}var o,i}var V=function(){function e(t,n,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this),this.id=t,this.handle=n,this.resolve=o,this.reject=i}var t,n,o;return t=e,(n=[{key:"resolveWith",value:function(e){this.resolve(e),this.emit("resolved",this.id)}},{key:"rejectWith",value:function(e){this.reject(e),this.emit("rejected",this.id)}}])&&U(t.prototype,n),o&&U(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==K(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==K(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===K(i)?i:String(i)),r)}var o,i}var $=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.assign(this,t),r(this),this.resolvers={},this.requestId=0,this.openedPromise=void 0,this.closeEvent=void 0}var t,n,o;return t=e,n=[{key:"open",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!t&&this.openedPromise)return this.openedPromise;try{this.socket=this.createSocket(this.url)}catch(e){return this.Promise.reject(e)}return this.socket.onopen=this.onOpen.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onerror=this.onError.bind(this),this.socket.onmessage=this.onMessage.bind(this),this.openedPromise=new this.Promise((function(t,n){return e.registerResolver("opened",null,t,n)})),this.closedPromise=new this.Promise((function(t,n){return e.registerResolver("closed",null,t,n)})),this.openedPromise}},{key:"onOpen",value:function(){var e=this;this.resolvers.opened.resolveWith((function(){return e.closedPromise}))}},{key:"onClose",value:function(e){this.emit("closed",e),this.closeEvent=e,this.resolvers&&this.resolvers.closed&&this.resolvers.closed.resolveWith(e),this.rejectAllOutstandingResolvers(h(y,"Socket closed",e))}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.socket&&(this.socket.close(e,t),this.socket=null),this.closedPromise}},{key:"onError",value:function(e){this.resolvers.opened?this.resolvers.opened.rejectWith(e):this.emit("socket-error",e),this.rejectAllOutstandingResolvers(h(y,"Socket error",e))}},{key:"onMessage",value:function(e){var t=JSON.parse(e.data),n=this.resolvers[t.id]||{};this.emit("traffic","received",t,n.handle),void 0!==t.id&&this.resolvers[t.id]?(this.emit("message",t),this.resolvers[t.id].resolveWith(t)):this.emit(t.params?"notification":"message",t)}},{key:"rejectAllOutstandingResolvers",value:function(e){var t=this;Object.keys(this.resolvers).forEach((function(n){"opened"!==n&&"closed"!==n&&t.resolvers[n].rejectWith(e)}))}},{key:"unregisterResolver",value:function(e){this.resolvers[e].removeAllListeners(),delete this.resolvers[e]}},{key:"registerResolver",value:function(e,t,n,r){var o=this,i=new V(e,t,n,r);this.resolvers[e]=i,i.on("resolved",(function(e){return o.unregisterResolver(e)})),i.on("rejected",(function(e){return o.unregisterResolver(e)}))}},{key:"send",value:function(e){var t=this;if(!this.socket||this.socket.readyState!==this.socket.OPEN){var n=h(y,"Not connected",this.closeEvent);return this.Promise.reject(n)}return e.id||(e.id=this.createRequestId()),e.jsonrpc="2.0",new this.Promise((function(n,r){return t.socket.send(JSON.stringify(e)),t.emit("traffic","sent",e,e.handle),t.registerResolver(e.id,e.handle,n,r)}))}},{key:"createRequestId",value:function(){return this.requestId+=1,this.requestId}}],n&&J(t.prototype,n),o&&J(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==Y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Y(i)?i:String(i)),r)}var o,i}var Q=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.assign(this,t),this.isSuspended=!1,this.rpc.on("traffic",(function(e,t){"sent"===e&&"OpenDoc"===t.method&&(n.openDocParams=t.params)}))}var t,n,r;return t=e,n=[{key:"restoreRpcConnection",value:function(e){var t=this;return this.reopen(5e3).then((function(n){return"SESSION_CREATED"===n&&e?t.Promise.reject(h(k,"Not attached")):t.Promise.resolve()}))}},{key:"restoreGlobal",value:function(e){var t=this.apis.getApisByType("Global").pop();return e.push(t.api),this.Promise.resolve()}},{key:"restoreDoc",value:function(e,t){var n=this,r=this.apis.getApisByType("Doc").pop();return r?this.rpc.send({method:"GetActiveDoc",handle:-1,params:[]}).then((function(e){return e.error&&n.openDocParams?n.rpc.send({method:"OpenDoc",handle:-1,params:n.openDocParams}):e})).then((function(o){if(o.error)return e.push(r.api),n.Promise.resolve();var i=o.result.qReturn.qHandle;return r.api.handle=i,t.push(r.api),n.Promise.resolve(r.api)})):this.Promise.resolve()}},{key:"restoreDocObjects",value:function(t,n,r){var o=this,i=[],s=this.apis.getApis().map((function(e){return e.api})).filter((function(e){return"Global"!==e.type&&"Doc"!==e.type}));return t?(s.forEach((function(s){var u=e.buildGetMethodName(s.type);if(u){var c=o.rpc.send({method:u,handle:t.handle,params:[s.id]}).then((function(e){e.error||!e.result.qReturn.qHandle?n.push(s):(s.handle=e.result.qReturn.qHandle,r.push(s))}));i.push(c)}else n.push(s)})),this.Promise.all(i)):(s.forEach((function(e){return n.push(e)})),this.Promise.resolve())}},{key:"suspend",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4e3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.isSuspended=!0,this.rpc.close(e,t)}},{key:"resume",value:function(e){var t=this,n=[],r=[];return this.restoreRpcConnection(e).then((function(){return t.restoreGlobal(n)})).then((function(){return t.restoreDoc(r,n)})).then((function(e){return t.restoreDocObjects(e,r,n)})).then((function(){t.isSuspended=!1,t.apis.clear(),r.forEach((function(e){e.emit("closed"),e.removeAllListeners()})),n.forEach((function(e){t.apis.add(e.handle,e),"Global"!==e.type&&e.emit("changed")}))})).catch((function(e){return t.rpc.close().then((function(){return t.Promise.reject(e)}))}))}},{key:"reopen",value:function(e){var t,n,r=this,o=!1,i=new this.Promise((function(e){n=e})),s=function(e){"OnConnected"===e.method&&(clearTimeout(t),n(e.params.qSessionState),o=!0)};return this.rpc.on("notification",s),this.rpc.open(!0).then((function(){return o||(t=setTimeout((function(){return n("SESSION_CREATED")}),e)),i})).then((function(e){return r.rpc.removeListener("notification",s),e})).catch((function(e){return r.rpc.removeListener("notification",s),r.Promise.reject(e)}))}}],r=[{key:"buildGetMethodName",value:function(e){return"Field"===e||"Variable"===e?null:"GenericVariable"===e?"GetVariableById":e.replace("Generic","Get")}}],n&&z(t.prototype,n),r&&z(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function X(e,t){var n=e.config.protocol.delta&&-1!==t.outKey&&"qSuccess"!==t.outKey;return n&&(t.delta=n),t}function Z(e,t,n){if(n&&n.qHandle&&n.qType)return e.getObjectApi({handle:n.qHandle,type:n.qType,id:n.qGenericId,genericType:n.qGenericType});if(n&&null===n.qHandle&&null===n.qType){var r=h(v,"Object not found");return e.config.Promise.reject(r)}return n}var ee=Object.prototype.hasOwnProperty,te=Object.prototype.toString,ne=Object.defineProperty,re=Object.getOwnPropertyDescriptor,oe=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===te.call(e)},ie=function(e){if(!e||"[object Object]"!==te.call(e))return!1;var t,n=ee.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&ee.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;for(t in e);return void 0===t||ee.call(e,t)},se=function(e,t){ne&&"__proto__"===t.name?ne(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},ue=function(e,t){if("__proto__"===t){if(!ee.call(e,t))return;if(re)return re(e,t).value}return e[t]};function ce(e){return function(e){if(Array.isArray(e))return ae(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ae(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function le(e){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},le(e)}var fe=function e(){var t,n,r,o,i,s,u=arguments[0],c=1,a=arguments.length,l=!1;for("boolean"==typeof u&&(l=u,u=arguments[1]||{},c=2),(null==u||"object"!=typeof u&&"function"!=typeof u)&&(u={});c<a;++c)if(null!=(t=arguments[c]))for(n in t)r=ue(u,n),u!==(o=ue(t,n))&&(l&&o&&(ie(o)||(i=oe(o)))?(i?(i=!1,s=r&&oe(r)?r:[]):s=r&&ie(r)?r:{},se(u,{name:n,newValue:e(l,s,o)})):void 0!==o&&se(u,{name:n,newValue:o}));return u}.bind(null,!0),pe={},he=Array.isArray;function ye(e){return null!=e&&!Array.isArray(e)&&"object"===le(e)}function ve(e){return void 0===e}function de(e,t){return"function"==typeof e[t]||"$$"===t.substring(0,2)||"_"===t.substring(0,1)}function me(e,t){var n,r=t.substring(1).split("/").slice(0,-1);return r.forEach((function(t,o){if(o!==r.length){n=+t;var i=isNaN(n)?{}:[];e[n||t]=ve(e[n||t])?i:e[t],e=e[n||t]}})),e}function be(e,t){var n=!0;if(ye(e)&&ye(t))return Object.keys(e).length===Object.keys(t).length&&(Object.keys(e).forEach((function(r){be(e[r],t[r])||(n=!1)})),n);if(he(e)&&he(t)){if(e.length!==t.length)return!1;for(var r=0,o=e.length;r<o;r+=1)if(!be(e[r],t[r]))return!1;return!0}return e===t}function ge(e){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ge(e)}pe.generate=function(e,t,n){n=n||"";var r=[];return Object.keys(t).forEach((function(o){var i=function(e){return e?fe({},{val:e}).val:e}(t[o]),s=e[o],u="".concat(n,"/").concat(o);be(i,s)||de(t,o)||(ve(s)?r.push({op:"add",path:u,value:i}):ye(i)&&ye(s)?r=r.concat(pe.generate(s,i,u)):he(i)&&he(s)?r=r.concat(function(e,t,n){var r=[],o=e.slice(),i=-1;function s(e,t,n){if(e[n]&&ve(e[n].qInfo))return null;if(e[n]&&e[n].qInfo.qId===t)return n;for(var r=0,o=e.length;r<o;r+=1)if(e[r]&&e[r].qInfo.qId===t)return r;return-1}if(be(t,o))return r;if(!ve(t[0])&&ve(t[0].qInfo))return r.push({op:"replace",path:n,value:t}),r;for(var u=o.length-1;u>=0;u-=1)-1===(i=s(t,o[u].qInfo&&o[u].qInfo.qId,u))?(r.push({op:"remove",path:"".concat(n,"/").concat(u)}),o.splice(u,1)):r=r.concat(pe.generate(o[u],t[i],"".concat(n,"/").concat(u)));for(var c=0,a=t.length;c<a;c+=1)-1===(i=s(o,t[c].qInfo&&t[c].qInfo.qId))?(r.push({op:"add",path:"".concat(n,"/").concat(c),value:t[c]}),o.splice(c,0,t[c])):i!==c&&(r.push({op:"move",path:"".concat(n,"/").concat(c),from:"".concat(n,"/").concat(i)}),o.splice(c,0,o.splice(i,1)[0]));return r}(s,i,u)):r.push({op:"replace",path:"".concat(n,"/").concat(o),value:i}))})),Object.keys(e).forEach((function(o){ve(t[o])&&!de(e,o)&&r.push({op:"remove",path:"".concat(n,"/").concat(o)})})),r},pe.apply=function(e,t){t.forEach((function(t){var n,r=me(e,t.path),o=t.path.split("/").splice(-1)[0],i=o&&isNaN(+o)?r[o]:r[+o]||r,s=t.from?t.from.split("/").splice(-1)[0]:null;if("/"===t.path&&(r=null,i=e),"add"===t.op||"replace"===t.op)if(he(r))"-"===o&&(o=r.length),r.splice(+o,"add"===t.op?0:1,t.value);else if(he(i)&&he(t.value)){i.length=0;for(var u=0;u<t.value.length;u+=1e3){var c,a=t.value.slice(u,u+1e3);(c=i).push.apply(c,ce(a))}}else if(ye(i)&&ye(t.value))n=i,Object.keys(n).forEach((function(e){Object.getOwnPropertyDescriptor(n,e).configurable&&!de(n,e)&&delete n[e]})),fe(i,t.value);else{if(!r)throw h(m,"Patchee is not an object we can patch");r[o]=t.value}else if("move"===t.op){var l=me(e,t.from);he(r)?r.splice(+o,0,l.splice(+s,1)[0]):(r[o]=l[s],delete l[s])}else"remove"===t.op&&(he(r)?r.splice(+o,1):delete r[o])}))},pe.clone=function(e){return fe({},e)},pe.createPatch=function(e,t,n){var r={op:e.toLowerCase(),path:n};return"move"===r.op?r.from=t:void 0!==t&&(r.value=t),r},pe.updateObject=function(e,t){Object.keys(e).length?pe.apply(e,pe.generate(e,t)):fe(e,t)};var we={},je=function(e,t){!function(e){if(!we[e.id]){var t={};we[e.id]=t,e.on("traffic:received",(function(e){return e.close&&e.close.forEach((function(e){return delete t[e]}))})),e.on("closed",(function(){return delete we[e.id]}))}}(e);var n=we[e.id];return n[t]||(n[t]=new N),n[t]};function Se(e,t,n){var r=n.delta,o=n.result;return r?(Object.keys(o).forEach((function(n){if(!Array.isArray(o[n]))throw h(d,"Unexpected RPC response, expected array of patches");o[n]=function(e,t,n,r){var o=je(e,t),i=o.get(n);return void 0===i&&(i=Array.isArray(r[0].value)?[]:{}),r.length&&("/"===r[0].path&&"object"!==ge(r[0].value)?i=r[0].value:pe.apply(i,r),o.set(n,i)),i}(e,t.handle,"".concat(t.method,"-").concat(n),o[n])})),JSON.parse(JSON.stringify(n))):n}function Oe(e,t,n){if(void 0!==n.error){var r=n.error,o=new Error(r.message);return o.code=r.code,o.parameter=r.parameter,e.config.Promise.reject(o)}return n}Se.sessions=we;var Pe="qReturn";function ke(e,t,n){return"CreateSessionApp"===t.method||"CreateSessionAppFromApp"===t.method?n.qReturn.qGenericId=n.qSessionAppId||n.qReturn.qGenericId:"GetInteract"!==t.method&&"StoreTempSelectionState"!==t.method&&"CreateTemporaryBookmark"!==t.method||delete n.qReturn,hasOwnProperty.call(n,Pe)?n.qReturn:-1!==t.outKey?n[t.outKey]:n}function Ee(e,t,n){return n.result}function _e(e){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_e(e)}function Ae(e){return function(e){if(Array.isArray(e))return Re(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Re(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==_e(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==_e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===_e(i)?i:String(i)),r)}var o,i}var qe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.assign(this,t),this.request=[{onFulfilled:X}].concat(Ae(this.request||[])),this.response=[{onFulfilled:Oe},{onFulfilled:Se},{onFulfilled:Ee},{onFulfilled:ke}].concat(Ae(this.response||[]),[{onFulfilled:Z}])}var t,n,r;return t=e,(n=[{key:"executeRequests",value:function(e,t){var n=this;return this.request.reduce((function(t,r){var o=r.onFulfilled&&r.onFulfilled.bind(n,e);return t.then(o)}),t)}},{key:"executeResponses",value:function(e,t,n){var r=this;return this.response.reduce((function(t,o){return t.then(o.onFulfilled&&o.onFulfilled.bind(r,e,n),o.onRejected&&o.onRejected.bind(r,e,n))}),t)}}])&&Te(t.prototype,n),r&&Te(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function xe(e){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xe(e)}function Ce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==xe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==xe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===xe(i)?i:String(i)),r)}var o,i}function Le(){return Le="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Ne(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Le.apply(this,arguments)}function Ne(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Me(e)););return e}function De(e,t){return De=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},De(e,t)}function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Me(e);if(t){var o=Me(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ge(this,n)}}function Ge(e,t){if(t&&("object"===xe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Me(e){return Me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Me(e)}var He=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&De(e,t)}(i,e);var t,n,r,o=Fe(i);function i(){return Ce(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"add",value:function(e,t){var n=this,r={api:t};return Le(Me(i.prototype),"add",this).call(this,e.toString(),r),t.on("closed",(function(){return n.remove(e)})),r}},{key:"getApi",value:function(e){var t=void 0!==e?this.get(e.toString()):void 0;return t&&t.api}},{key:"getApis",value:function(){return Le(Me(i.prototype),"getAll",this).call(this).map((function(e){return{handle:e.key,api:e.value.api}}))}},{key:"getApisByType",value:function(e){return this.getApis().filter((function(t){return t.api.type===e}))}}])&&Ie(t.prototype,n),r&&Ie(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(N);function Be(e){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Be(e)}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==Be(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Be(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Be(i)?i:String(i)),r)}var o,i}return function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getSession",value:function(e){var t=e.createSocket,n=e.Promise,r=e.requestInterceptors,o=e.responseInterceptors,i=e.url,s=new He,u=new qe({apis:s,Promise:n,request:r,response:o}),c=new $({createSocket:t,Promise:n,url:i}),a=new Q({apis:s,Promise:n,rpc:c});return new C({apis:s,config:e,intercept:u,rpc:c,suspendResume:a})}},{key:"configureDefaults",value:function(e){if(!e)throw h(g,"You need to supply a configuration.");if(!e.Promise&&"undefined"==typeof Promise)throw h(w,"Your environment has no Promise implementation. You must provide a Promise implementation in the config.");"function"!=typeof e.createSocket&&"function"==typeof WebSocket&&(e.createSocket=function(e){return new WebSocket(e)}),void 0===e.suspendOnClose&&(e.suspendOnClose=!1),e.protocol=e.protocol||{},e.protocol.delta=void 0===e.protocol.delta||e.protocol.delta,e.Promise=e.Promise||Promise,e.mixins=e.mixins||[],e.definition=e.definition||new B(e)}},{key:"create",value:function(t){return e.configureDefaults(t),t.mixins.forEach((function(e){t.definition.registerMixin(e)})),e.getSession(t)}}],(n=null)&&We(t.prototype,n),r&&We(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()}));
//# sourceMappingURL=enigma.min.js.map
